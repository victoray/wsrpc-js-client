{"version":3,"file":"wsrpc.js","sources":["../wsrpc.es6.js"],"sourcesContent":["class Deferred {\n\tconstructor() {\n\t\tconst self = this;\n\n\t\tself.resolve = null;\n\t\tself.reject = null;\n\t\tself.done = false;\n\n\t\tfunction wrapper(func) {\n\t\t\treturn function () {\n\t\t\t\tif (self.done) {\n\t\t\t\t\tconsole.error(new Error('Promise already done'));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tself.done = true;\n\t\t\t\treturn func.apply(this, arguments);\n\t\t\t}\n\t\t}\n\n\t\tself.promise = new Promise(\n\t\t\t(resolve, reject) => {\n\t\t\t\tself.resolve = wrapper(resolve);\n\t\t\t\tself.reject = wrapper(reject);\n\t\t\t}\n\t\t);\n\n\t\tself.promise.isPending = () => { return !self.done };\n\t\treturn self;\n\t}\n}\n\nfunction logGroup(group, level, args) {\n\tconsole.group(group);\n\tconsole[level].apply(this, args);\n\tconsole.groupEnd();\n}\n\nfunction log() {\n\tif (!WSRPC.DEBUG) return;\n\tlogGroup('WSRPC.DEBUG', 'trace', arguments);\n}\n\nfunction trace (msg) {\n\tif (!WSRPC.TRACE) return;\n\n\tlet payload = msg;\n\tif ('data' in msg) payload = JSON.parse(msg.data);\n\tlogGroup(\"WSRPC.TRACE\", 'trace', [payload]);\n}\n\nfunction getAbsoluteWsUrl(url) {\n\tif ((/^\\w+:\\/\\//).test(url)) return url;\n\tif (typeof window == 'undefined' && window.location.host.length < 1)\n\t\tthrow new Error(\n\t\t\t`Can not construct absolute URL from ${window.location}`\n\t\t);\n\tconst scheme = window.location.protocol === \"https:\" ? \"wss:\" : \"ws:\";\n\tconst port = window.location.port === '' ? `:${window.location.port}` : '';\n\tconst host = window.location.host;\n\tconst path = url.replace(/^\\/+/gm, '');\n\treturn `${scheme}//${host}${port}/${path}`;\n}\n\nconst readyState = Object.freeze({\n\t0: 'CONNECTING',\n\t1: 'OPEN',\n\t2: 'CLOSING',\n\t3: 'CLOSED'\n});\n\nclass WSRPC {\n\tconstructor (URL, reconnectTimeout = 1000) {\n\t\tlet self = this;\n\n\t\tURL = getAbsoluteWsUrl(URL);\n\n\t\tself.id = 1;\n\t\tself.eventId = 0;\n\t\tself.socketStarted = false;\n\t\tself.eventStore = {\n\t\t\tonconnect: {},\n\t\t\tonerror: {},\n\t\t\tonclose: {},\n\t\t\tonchange: {}\n\t\t};\n\t\tself.connectionNumber = 0;\n\t\tself.oneTimeEventStore = {\n\t\t\tonconnect: [],\n\t\t\tonerror: [],\n\t\t\tonclose: [],\n\t\t\tonchange: []\n\t\t};\n\n\t\tself.callQueue = [];\n\n\t\tfunction createSocket() {\n\t\t\tlet ws = new WebSocket(URL);\n\n\t\t\tlet rejectQueue = function () {\n\t\t\t\tself.connectionNumber++; // rejects incoming calls\n\t\t\t\tlet deferred;\n\n\t\t\t\t//reject all pending calls\n\t\t\t\twhile (0 < self.callQueue.length) {\n\t\t\t\t\tlet callObj = self.callQueue.shift();\n\t\t\t\t\tdeferred = self.store[callObj.id];\n\t\t\t\t\tdelete self.store[callObj.id];\n\n\t\t\t\t\tif (deferred && deferred.promise.isPending()) {\n\t\t\t\t\t\tdeferred.reject('WebSocket error occurred');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// reject all from the store\n\t\t\t\tfor (let key in self.store) {\n\t\t\t\t\tif (!self.store.hasOwnProperty(key)) continue;\n\n\t\t\t\t\tdeferred = self.store[key];\n\t\t\t\t\tif (deferred && deferred.promise.isPending()) {\n\t\t\t\t\t\tdeferred.reject('WebSocket error occurred');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tfunction reconnect(callEvents) {\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tself.socket = createSocket();\n\t\t\t\t\t\tself.id = 1;\n\t\t\t\t\t} catch (exc) {\n\t\t\t\t\t\tcallEvents('onerror', exc);\n\t\t\t\t\t\tdelete self.socket;\n\t\t\t\t\t\tconsole.error(exc);\n\t\t\t\t\t}\n\t\t\t\t}, reconnectTimeout);\n\t\t\t}\n\n\t\t\tws.onclose = function (err) {\n\t\t\t\tlog('ONCLOSE CALLED', 'STATE', self.public.state());\n\t\t\t\ttrace(err);\n\n\t\t\t\tfor (let serial in self.store) {\n\t\t\t\t\tif (!self.store.hasOwnProperty(serial)) continue;\n\t\t\t\t\tif (self.store[serial].hasOwnProperty('reject')) {\n\t\t\t\t\t\tself.store[serial].reject('Connection closed');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trejectQueue();\n\t\t\t\tcallEvents('onclose', err);\n\t\t\t\tcallEvents('onchange', err);\n\t\t\t\treconnect(callEvents);\n\t\t\t};\n\n\t\t\tws.onerror = function (err) {\n\t\t\t\tlog('ONERROR CALLED', 'STATE', self.public.state());\n\t\t\t\ttrace(err);\n\n\t\t\t\trejectQueue();\n\t\t\t\tcallEvents('onerror', err);\n\t\t\t\tcallEvents('onchange', err);\n\n\t\t\t\tlog('WebSocket has been closed by error: ', err);\n\t\t\t};\n\n\t\t\tfunction tryCallEvent(func, event) {\n\t\t\t\ttry {\n\t\t\t\t\treturn func(event);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tif (e.hasOwnProperty('stack')) {\n\t\t\t\t\t\tlog(e.stack);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlog('Event function', func, 'raised unknown error:', e);\n\t\t\t\t\t}\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction callEvents(evName, event) {\n\t\t\t\twhile (0 < self.oneTimeEventStore[evName].length) {\n\t\t\t\t\tlet deferred = self.oneTimeEventStore[evName].shift();\n\t\t\t\t\tif (deferred.hasOwnProperty('resolve') &&\n\t\t\t\t\t\tdeferred.promise.isPending()) deferred.resolve();\n\t\t\t\t}\n\n\t\t\t\tfor (let i in self.eventStore[evName]) {\n\t\t\t\t\tif (!self.eventStore[evName].hasOwnProperty(i)) continue;\n\t\t\t\t\tlet cur = self.eventStore[evName][i];\n\t\t\t\t\ttryCallEvent(cur, event);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tws.onopen = function (ev) {\n\t\t\t\tlog('ONOPEN CALLED', 'STATE', self.public.state());\n\t\t\t\ttrace(ev);\n\n\t\t\t\twhile (0 < self.callQueue.length) {\n\t\t\t\t\t// noinspection JSUnresolvedFunction\n\t\t\t\t\tself.socket.send(JSON.stringify(self.callQueue.shift(), 0, 1));\n\t\t\t\t}\n\n\t\t\t\tcallEvents('onconnect', ev);\n\t\t\t\tcallEvents('onchange', ev);\n\t\t\t};\n\n\t\t\tfunction handleCall(self, data) {\n\t\t\t\tif (!self.routes.hasOwnProperty(data.method))\n\t\t\t\t\tthrow new Error('Route not found');\n\n\t\t\t\tlet connectionNumber = self.connectionNumber;\n\t\t\t\tlet deferred = new Deferred();\n\n\t\t\t\tdeferred.promise.then(\n\t\t\t\t\tfunction (result) {\n\t\t\t\t\t\tif (connectionNumber !== self.connectionNumber) return;\n\t\t\t\t\t\tself.socket.send(JSON.stringify({\n\t\t\t\t\t\t\tid: data.id,\n\t\t\t\t\t\t\tresult: result\n\t\t\t\t\t\t}));\n\t\t\t\t\t},\n\t\t\t\t\tfunction (error) {\n\t\t\t\t\t\tif (connectionNumber !== self.connectionNumber) return;\n\t\t\t\t\t\tself.socket.send(JSON.stringify({\n\t\t\t\t\t\t\tid: data.id,\n\t\t\t\t\t\t\terror: error\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tlet func = self.routes[data.method];\n\n\t\t\t\tif (self.asyncRoutes[data.method])\n\t\t\t\t\treturn func.apply(deferred, [data]);\n\n\t\t\t\tfunction badPromise() {\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\"You should register route with async flag.\"\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tlet promiseMock = {\n\t\t\t\t\tresolve: badPromise,\n\t\t\t\t\treject: badPromise,\n\t\t\t\t};\n\n\t\t\t\ttry {\n\t\t\t\t\tdeferred.resolve(func.apply(promiseMock, [data]));\n\t\t\t\t} catch (e) {\n\t\t\t\t\tdeferred.reject(e);\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction handleError(self, data) {\n\t\t\t\tif (!self.store.hasOwnProperty(data.id))\n\t\t\t\t\treturn log('Unknown callback');\n\n\t\t\t\tlet deferred = self.store[data.id];\n\n\t\t\t\tif (typeof deferred === 'undefined')\n\t\t\t\t\treturn log('Confirmation without handler');\n\n\t\t\t\tdelete self.store[data.id];\n\t\t\t\tlog('REJECTING', data.error);\n\t\t\t\tdeferred.reject(data.error);\n\t\t\t}\n\n\t\t\tfunction handleResult(self, data) {\n\t\t\t\tlet deferred = self.store[data.id];\n\t\t\t\tif (typeof deferred === 'undefined')\n\t\t\t\t\treturn log('Confirmation without handler');\n\n\t\t\t\tdelete self.store[data.id];\n\n\t\t\t\tif (data.hasOwnProperty('result')) {\n\t\t\t\t\treturn deferred.resolve(data.result);\n\t\t\t\t}\n\t\t\t\treturn deferred.reject(data.error);\n\t\t\t}\n\n\t\t\tws.onmessage = function (message) {\n\t\t\t\tlog('ONMESSAGE CALLED', 'STATE', self.public.state());\n\t\t\t\ttrace(message);\n\n\t\t\t\tif (message.type !== 'message') return;\n\n\t\t\t\tlet data;\n\n\t\t\t\ttry {\n\t\t\t\t\tdata = JSON.parse(message.data);\n\t\t\t\t\tlog(data);\n\n\t\t\t\t\tif (!data.hasOwnProperty('id')) {\n\t\t\t\t\t\tlet current;\n\n\t\t\t\t\t\tconsole.group(\"Event received\");\n\t\t\t\t\t\tfor (let i = 0; i < self.socketEventsListeners.length; i++) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tcurrent = self.socketEventsListeners[i];\n\t\t\t\t\t\t\t\tcurrent.apply(self.public, [data]);\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconsole.groupEnd();\n\t\t\t\t\t} else if (data.hasOwnProperty('method')) {\n\t\t\t\t\t\treturn handleCall(self, data);\n\t\t\t\t\t} else if (data.hasOwnProperty('error') && data.error === null) {\n\t\t\t\t\t\treturn handleError(self, data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn handleResult(self, data);\n\t\t\t\t\t}\n\t\t\t\t} catch (exception) {\n\t\t\t\t\tlet err = {\n\t\t\t\t\t\terror: exception.message,\n\t\t\t\t\t\tresult: null,\n\t\t\t\t\t\tid: data ? data.id : null\n\t\t\t\t\t};\n\n\t\t\t\t\tself.socket.send(JSON.stringify(err));\n\t\t\t\t\tconsole.error(exception);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treturn ws;\n\t\t}\n\n\t\tfunction makeCall(func, args, params) {\n\t\t\tself.id += 2;\n\t\t\tlet deferred = new Deferred();\n\n\t\t\tlet callObj = Object.freeze({\n\t\t\t\tid: self.id,\n\t\t\t\tmethod: func,\n\t\t\t\tparams: args\n\t\t\t});\n\n\t\t\tlet state = self.public.state();\n\n\t\t\tif (state === 'OPEN') {\n\t\t\t\tself.store[self.id] = deferred;\n\t\t\t\tself.socket.send(JSON.stringify(callObj));\n\t\t\t} else if (state === 'CONNECTING') {\n\t\t\t\tlog('SOCKET IS', state);\n\t\t\t\tself.store[self.id] = deferred;\n\t\t\t\tself.callQueue.push(callObj);\n\t\t\t} else {\n\t\t\t\tlog('SOCKET IS', state);\n\t\t\t\tif (params && params['noWait']) {\n\t\t\t\t\tdeferred.reject(`Socket is: ${state}`);\n\t\t\t\t} else {\n\t\t\t\t\tself.store[self.id] = deferred;\n\t\t\t\t\tself.callQueue.push(callObj);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn deferred.promise;\n\t\t}\n\n\t\tself.socketEventsListeners = [function (event) {console.log(event);}];\n\t\tself.asyncRoutes = {};\n\t\tself.routes = {};\n\t\tself.store = {};\n\t\tself.public = Object.freeze({\n            defer: function () {\n                return new Deferred();\n            },\n\t\t\tcall: function (func, args, params) {\n\t\t\t\treturn makeCall(func, args, params);\n\t\t\t},\n\t\t\taddRoute: function (route, callback, isAsync) {\n\t\t\t\tself.asyncRoutes[route] = isAsync || false;\n\t\t\t\tself.routes[route] = callback;\n\t\t\t},\n\t\t\tdeleteRoute: function (route) {\n\t\t\t\tdelete self.asyncRoutes[route];\n\t\t\t\treturn delete self.routes[route];\n\t\t\t},\n\t\t\taddEventListener: function (event, func) {\n\t\t\t\tlet eventId = self.eventId++;\n\t\t\t\tself.eventStore[event][eventId] = func;\n\t\t\t\treturn eventId;\n\t\t\t},\n\t\t\tremoveEventListener: function (event, index) {\n\t\t\t\tif (self.eventStore[event].hasOwnProperty(index)) {\n\t\t\t\t\tdelete self.eventStore[event][index];\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\t\t\tonEvent: function (event) {\n\t\t\t\tlet deferred = new Deferred();\n\t\t\t\tself.oneTimeEventStore[event].push(deferred);\n\t\t\t\treturn deferred.promise;\n\t\t\t},\n\t\t\tdestroy: function () {\n\t\t\t\treturn self.socket.close();\n\t\t\t},\n\t\t\tstate: function () {\n\t\t\t\treturn readyState[this.stateCode()];\n\t\t\t},\n\t\t\tstateCode: function () {\n\t\t\t\tif (self.socketStarted && self.socket)\n\t\t\t\t\treturn self.socket.readyState;\n\t\t\t\treturn 3;\n\t\t\t},\n\t\t\tconnect: function () {\n\t\t\t\tself.socketStarted = true;\n\t\t\t\tself.socket = createSocket();\n\t\t\t},\n\t\t\taddServerEventListener: function (callable) {\n\t\t\t\treturn self.socketEventsListeners.push(callable) - 1;\n\t\t\t},\n\t\t\tremoveServerEventListener: function (index) {\n\t\t\t    return self.socketEventsListeners.splice(index, 1).length;\n\t\t\t},\n            sendRaw: function (data) {\n                return self.socket.send(data);\n            }\n\t\t});\n\n\t\tself.public.addRoute('log', function (argsObj) {\n\t\t\tconsole.info(`Websocket sent: ${argsObj}`);\n\t\t});\n\n\t\tself.public.addRoute('ping', function (data) {\n\t\t\treturn data;\n\t\t});\n\n\t\treturn self.public;\n\t}\n}\n\nWSRPC.DEBUG = false;\nWSRPC.TRACE = false;\n\nexport default WSRPC;\n"],"names":["Deferred","self","resolve","reject","done","wrapper","func","console","error","Error","apply","arguments","promise","Promise","isPending","logGroup","group","level","args","groupEnd","log","WSRPC","DEBUG","trace","msg","TRACE","payload","JSON","parse","data","getAbsoluteWsUrl","url","test","window","location","host","length","scheme","protocol","port","path","replace","readyState","Object","freeze","URL","reconnectTimeout","id","eventId","socketStarted","eventStore","onconnect","onerror","onclose","onchange","connectionNumber","oneTimeEventStore","callQueue","createSocket","ws","WebSocket","rejectQueue","deferred","callObj","shift","store","key","hasOwnProperty","reconnect","callEvents","setTimeout","socket","exc","err","public","state","serial","tryCallEvent","event","e","stack","evName","i","cur","onopen","ev","send","stringify","handleCall","routes","method","then","result","asyncRoutes","badPromise","promiseMock","handleError","handleResult","onmessage","message","type","current","socketEventsListeners","exception","makeCall","params","push","defer","call","addRoute","route","callback","isAsync","deleteRoute","addEventListener","removeEventListener","index","onEvent","destroy","close","stateCode","connect","addServerEventListener","callable","removeServerEventListener","splice","sendRaw","argsObj","info"],"mappings":"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"}